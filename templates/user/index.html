{% load static %}

<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="{% static 'images/favicon.png' %}" type="image/x-icon">

    <title>Registration</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
            crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <script src="{% static "js/input-cheking.js" %}"></script>
    <script>
    function handleData() {
        var form_data = new FormData(document.querySelector("form"));

        if (form_data.has("humanitarian_education_direction") ||
            form_data.has("technical_education_direction") ||
            form_data.has("environmental_education_direction") ||
            form_data.has("economical_education_direction")) {
            document.getElementById("chk_option_error").style.visibility = "hidden";
            return true;
        } else {
            document.getElementById("chk_option_error").style.visibility = "visible";
            return false;
        }
    }
</script>
<script>
    function basic_agreement_check() {
        if (!(document.getElementById("id_data_processing_consent_0").checked
            && document.getElementById("id_content_familiar_0").checked)) {
            blur_form()
        } else {
            unblur_form()
        }
    }

    function blur_form() {
        document.getElementById("chk_option_error").style.visibility = "hidden";
        $("#disable-form").find("input,select,textarea,button").prop("disabled", true);
        document.getElementById("disable-form").classList.add("background-blur");
        document.getElementById('agreement_required').style.visibility = "visible";
        document.getElementById('agreement_required').style.display = "block";
    }

    function unblur_form() {
        $("#disable-form").find("input,select,textarea,button").prop("disabled", false);
        document.getElementById("disable-form").classList.remove("background-blur");
        document.getElementById('agreement_required').style.visibility = "hidden";
        document.getElementById('agreement_required').style.display = "none";
    }
</script>
    <link href="{% static 'css/forms.css' %}" rel="stylesheet">
</head>

<body class="bg-light"  onload="return basic_agreement_check()">

<div class="container mt-3">
    <div class="text text-center">
        <h3>Enter a brief information about yourself to receive statistical data</h3>
        <p class="text-end" style="color:red">*all fields are required to be filled in</p>
        <hr class="mb-4">
    </div>
    <div class="card">
        <form class="needs-validation" method="post" onsubmit="return handleData()" novalidate>
            {% csrf_token %}
            <div class="row" onchange="basic_agreement_check()">
                <div class="col">
                    <div class="col-md-12 mb-3">
                        <label class="form-control-label" for="data_processing_consent">Do you consent to the processing
                            of your data?</label>
                        <div class="d-block">
                            {% for data_processing_consent in form.data_processing_consent %}
                            <div class="custom-control custom-radio">
                                {{ data_processing_consent }}
                                {% if forloop.last %}
                                <div class="invalid-feedback">Choose one of the answers</div>
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="col-md-12 mb-3">
                        <label class="form-control-label" for="content_familiar">Are you familiar with the content of
                            the project?</label>
                        <div class="d-block">
                            {% for content_familiar in form.content_familiar %}
                            <div class="custom-control custom-radio">
                                {{ content_familiar }}
                                {% if forloop.last %}
                                <div class="invalid-feedback">Choose one of the answers</div>
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            <p id="agreement_required" class="text-center" style="color:red; visibility: hidden; display: none;">Grant the appropriate permissions for further form filling</p>
            <hr class="mb-4">
            <div id="disable-form">
                <div class="row">
                    <div class="col">
                        <div class="col-md-12 mb-3">
                            <label class="form-control-label" for="Name">First and last name</label>
                            {{ form.name }}
                            <div class="invalid-feedback">Enter a valid name</div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="col-md-12 mb-3">
                            <label class="form-control-label" for="email">Email</label>
                            {{ form.email }}
                            <div class="invalid-feedback">Enter the correct email address</div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="col-md-12 mb-3">
                            <div class="form-control-label">Sex</div>
                            <div class="d-block">
                                {% for sex in form.sex %}
                                <div class="custom-control custom-radio">
                                    {{ sex }}
                                    {% if forloop.last %}
                                    <div class="invalid-feedback">Choose one of the answers</div>
                                    {% endif %}
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="col-md-12 mb-3">
                            <label class="form-control-label" for="age">Age</label>
                            {{ form.age }}
                            <div class="invalid-feedback">Choose one of the answers</div>
                        </div>
                        <div class="col-md-12 mb-3">
                            <label class="form-control-label" for="income">Income</label>
                            {{ form.income }}
                            <div class="invalid-feedback">Choose one of the answers</div>
                        </div>
                        <div class="col-md-12 mb-3">
                            <div class="form-control-label">Marital status</div>
                            <div class="d-block">
                                {% for marital_status in form.marital_status %}
                                <div class="custom-control custom-radio">
                                    {{ marital_status }}
                                    {% if forloop.last %}
                                    <div class="invalid-feedback">Choose one of the answers</div>
                                    {% endif %}
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="col-md-12 mb-3">
                            <div class="form-control-label">Presence of children</div>
                            <div class="d-block">
                                {% for children_status in form.children_status %}
                                <div class="custom-control custom-radio">
                                    {{ children_status }}
                                    {% if forloop.last %}
                                    <div class="invalid-feedback">Choose one of the answers</div>
                                    {% endif %}
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="col-md-12 mb-3">
                            <label class="form-control-label" for="education">Education</label>
                            {{ form.education }}
                            <div class="invalid-feedback">Choose one of the answers</div>
                        </div>
                        <div class="col-md-12 mb-3">
                            <div class="form-control-label">Doctorate</div>
                            <div class="d-block">
                                {% for degree in form.degree %}
                                <div class="custom-control custom-radio">
                                    {{ degree }}
                                    {% if forloop.last %}
                                    <div class="invalid-feedback">Choose one of the answers</div>
                                    {% endif %}
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="col-md-12 mb-3">
                            <div onchange="return handleData()">
                                <div class="form-control-label">Education direction</div>
                                <div class="custom-control custom-checkbox">
                                    {{ form.economical_education_direction }} {{ form.economical_education_direction.label }}
                                </div>
                                <div class="custom-control custom-checkbox">
                                    {{ form.technical_education_direction }} {{ form.technical_education_direction.label }}
                                </div>
                                <div class="custom-control custom-checkbox">
                                    {{ form.environmental_education_direction }} {{ form.environmental_education_direction.label }}
                                </div>
                                <div class="custom-control custom-checkbox">
                                    {{ form.humanitarian_education_direction }} {{ form.humanitarian_education_direction.label }}
                                </div>
                                <div style="visibility:hidden;" id="chk_option_error">Choose one of the answers</div>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="col-md-12 mb-3">
                            <label class="form-control-label" for="driving_experience">Experience of a car using</label>
                            {{ form.driving_experience }}
                            <div class="invalid-feedback">Choose one of the answers</div>
                        </div>
                        <div class="col-md-12 mb-3">
                            <div class="form-control-label">Does your professional activity involve risk, risk
                                assessment or management?
                            </div>
                            <div class="d-block">
                                {% for work_risk in form.work_risk %}
                                <div class="custom-control custom-radio">
                                    {{ work_risk }}
                                    {% if forloop.last %}
                                    <div class="invalid-feedback">Choose one of the answers</div>
                                    {% endif %}
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="col-md-12 mb-3">
                            <div class="form-control-label">Is there a gas station near your place of work?</div>
                            <div class="d-block">
                                {% for station_nearby_work in form.station_nearby_work %}
                                <div class="custom-control custom-radio">
                                    {{ station_nearby_work }}
                                    {% if forloop.last %}
                                    <div class="invalid-feedback">Choose one of the answers</div>
                                    {% endif %}
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="col-md-12 mb-3">
                            <div class="form-control-label">Is there a gas station near your place of residence?</div>
                            <div class="d-block">
                                {% for station_nearby_house in form.station_nearby_house %}
                                <div class="custom-control custom-radio">
                                    {{ station_nearby_house }}
                                    {% if forloop.last %}
                                    <div class="invalid-feedback">Choose one of the answers</div>
                                    {% endif %}
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                <hr class="mb-4">
                <div class="text-center col-md-12">
                    <button class="btn-primary btn-lg btn-block" type="submit">Go to survey</button>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->


</body>
</html>
